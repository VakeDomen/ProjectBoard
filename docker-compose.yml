version: '3.2'

services:
  backend:
    build:
      context: .
      dockerfile: ./dockerfiles/Dockerfile.backend
    restart: "unless-stopped"
    environment: 
      - PORT=3000
      - SQLITE_DB=./sqlite.db
    ports: 
      - 3000:3000
  frontend:
    build:
      context: .
      dockerfile: ./dockerfiles/Dockerfile.frontend
    restart: "unless-stopped"
    ports: 
      - 80:80
    labels:
      - traefik.enable=true
      - traefik.http.routers.project_board.rule=Host(`vakedomen.ml`)
      - traefik.http.routers.project_board.tls=true
      - traefik.http.routers.project_board.tls.certresolver=letsEncrypt
      - traefik.http.routers.project_board.service=project_board
      - traefik.http.services.project_board.loadbalancer.server.port=80
